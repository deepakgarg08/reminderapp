<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="jquery-3.4.1.min.js"></script>

    <title>Welcome to LALAkiSHop</title>
    <style>
        table {
            font-family: arial, sans-serif;
            /*border-collapse: collapse;*/
            width: 100%;
        }

        td, th {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        tr:nth-child(even) {
            background-color: #dddddd;
        }
    </style>
</head>
<body>

<h1>WELCOME TO THE LALAKISHOP</h1>
<div>
    <nav>
        <l1>Add New Customer &nbsp &nbsp &nbsp</l1>
        <button onclick="add()"> ADD</button>
        <l1>Update Customer Details &nbsp &nbsp &nbsp</l1>
        <button onclick="update()">UPDATE</button>
        <l1>Search Customer &nbsp &nbsp &nbsp</l1>
        <button onclick="readone()">SEARCH</button>
        <l1>Search All Customer &nbsp &nbsp &nbsp</l1>
        <button onclick="readall()">SEARCH ALL</button>
        <l1>Delete Customer &nbsp &nbsp &nbsp</l1>
        <button onclick="deleteCustomer()">DELETE</button>

    </nav>
</div>
<div>

    <h2 id="ncustomers">All customers list</h2>
    <div id="mainframe" style="display: none">

        <table id="mainTable">
            <tr>
                <th>id</th>
                <th>username</th>
                <th>name</th>
                <th>mobile</th>
                <th>address</th>
                <th>description</th>
                <th>extras</th>
                <th>created_date</th>
                <th>modified_date</th>
                <th>Products</th>

            </tr>

        </table>


    </div>

</div>

<script>
    let Total_No_of_Records
    $(document).ready(readall());
    // setTimeout(()=>{
    //     window.location.href = "createuser.html"
    // },1000)
    // window.location.href = "www.google.com"
    function add() {
        window.open("createuser.html", "_blank");
    }

    function update() {

        window.open("updateuser.html", "_blank");


    }

    function readone() {

    }

    function readall() {
        var tb = document.getElementById('mainTable');
        while (tb.rows.length > 1) {
            tb.deleteRow(1);
        }
        $.ajax({
            async: true,
            url: 'http://127.0.0.1:3000/readall',
            type: 'GET',
            // data: formjson,
            // dataType: 'JSON',
            success: function (res) {
                console.log("check response result ", res)
                // console.log("check response result ", res.Records.length)
                if (res === "you are not authorized") {
                    rec.innerHTML = "you are not authorized"
                } else {
                    mainframe.style.display = "block";
                    Total_No_of_Records = res.Total_No_of_Records
                    ncustomers.innerHTML = "All customers list   " + Total_No_of_Records

                    for (let i = 1; i < res.Records.length; i++) {
                        displayList(res.Records[i])
                    }
                }
            }
        });
    }

    function deleteCustomer() {
        window.open("delete.html", "_blank");
    }


    function displayList(data) {

        console.log("let Total_No_of_Records", Total_No_of_Records)
        var row = document.getElementById("mainTable").insertRow();
        // var productTable = document.getElementById("productTable").insertRow();
        // row.setAttribute("height", "50px", 0);
        // row.setAttribute("id", z, 0);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        var cell9 = row.insertCell(8);
        var cell10 = row.insertCell(9);

        console.log("data.products", data.products)

        if (data.extras === undefined || data.extras === "") {
            data.extras = "-"
        }

        if (data.description === undefined) {
            data.description = "-"
        }
        if (data.modified_date === undefined) {
            data.modified_date = "-";
        }
        if (data.address === undefined) {
            data.address = "-";
        }
        // if (data.products.length === 0 || data.products.length === null) {
        //     console.log("..........")
        //     data.products = "-";
        // } else {
        //     for (let i = 0; i < data.products.length; i++) {
        //         console.log("data.products[i]::", i)
        //         console.log(data.products[i].product_name)
        //     }
        // }

        // console.log("data.products...", data.products);


        cell1.innerHTML = data._id
        cell2.innerHTML = data.username
        cell3.innerHTML = data.name
        cell4.innerHTML = data.mobile
        cell5.innerHTML = data.address
        cell6.innerHTML = data.description
        cell7.innerHTML = data.extras
        cell8.innerHTML = data.created_date
        cell9.innerHTML = data.modified_date
        cell10.innerHTML = data.products


    }


</script>


</body>
</html>